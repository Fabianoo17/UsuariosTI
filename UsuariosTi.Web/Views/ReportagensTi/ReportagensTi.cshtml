@model UsuariosTi.Business.ViewModels.ViewModelReportagensTi
@{ ViewData["Title"] = "Reportagens TI";

    Layout = null;
    var destaque = Model.VW012_LISTA_DICASTI;
}
<style>
    @@-moz-document url-prefix() {
        .dicasTiImg {
            background: url('/imagens/Dicas_TI/dicas-ti2.jpg');
            background-size: 100% 100%;
            width: 100%;
            min-height: 750px;
        }

        .botao-sugestao {
            background: #ff9100 0% 0% no-repeat padding-box;
            border-radius: 5px;
            opacity: 1;
            position: center;
            z-index: 05;
            font-size: 16px;
            color: white;
            text-align: center;
            box-shadow: 9px 7px 5px rgba(50, 50, 50, 0.77);
            height: 42px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 100%
        }

        .emcima {
            cursor: pointer
        }

        .search-form {
            border-radius: 30px 0px 0px 30px;
        }

        .emcima:hover {
            font-weight: 900;
        }

        .search-form {
            border-radius: 30px 0px 0px 30px;
        }
    }

    .dicasTiImg {
        background: url('/imagens/Dicas_TI/dicas-ti2.jpg');
        background-size: 100% 100%;
        width: 100%;
        min-height: 750px;
    }

    .botao-sugestao {
        background: #ff9100 0% 0% no-repeat padding-box;
        border-radius: 5px;
        opacity: 1;
        position: center;
        z-index: 05;
        font-size: 16px;
        color: white;
        text-align: center;
        box-shadow: 9px 7px 5px rgba(50, 50, 50, 0.77);
        height: 42px;
        display: inline-flex;
        justify-content: center;
        align-items: center;
        width: 100%
    }

    .emcima {
        cursor: pointer
    }

    .search-form {
        border-radius: 30px 0px 0px 30px;
    }

    .emcima:hover {
        font-weight: 900;
    }

    .search-form {
        border-radius: 30px 0px 0px 30px;
    }
</style>

<section id="pag-dicasTI" class="dicasTiImg">

    <div class="row">
        <div class="col-12">
            <div class="row" style="margin-top:190px">
                <div class="col-2"></div>
                <div></div>
                <div class="col-4" style="padding-left:0px; padding-right:0px;">
                    <form asp-action="Index" id="form-pesquisa" style="width:95%; margin-left: 30px;">
                        @*onsubmit="return false">*@
                        <input placeholder="Pesquisa" id="pesquisa" name="pesquisa" class="form-control" type="text" style="height: 34px !important; font-size: 14px !important;" />
                    </form>

                </div>
                <div class="col-1" style="padding-left:0px; padding-right:0px;">
                    <button id="btnPesquisar" type="button" style="height: 34px !important;" class="btn btn-success ml-1 btn-group-sm"><i class="fa fa-search"></i></button>
                </div>
                <div class="col-1"></div>
                <div class="col-2">
                    <button type="button" class="botao-sugestao" data-toggle="modal" data-target="#modalSugestaoDicaTi">Sugira novas dicas</button>
                </div>
                <div class="col-2"></div>
            </div>
        </div>
        <div class="col-2"></div>

        <div class="col-8" style="margin-top: 30px; margin-left: 30px; flex-wrap: wrap;">

            <div id="ListarReportagensTI"></div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="modalSugestaoDicaTi" tabindex="1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Sugestões</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="col-md-12">
                        <form>
                            <input type="hidden" id="txtID" />
                            <textarea id="textoComentario" class="form-control" style="height: 120px; font-size: 17px;" placeholder="Digite aqui sua sugestão"></textarea>
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                    <button id="botaoEnviar" type="button" class="btn btn-primary" data-dismiss="modal">Enviar</button>
                </div>
            </div>
        </div>
    </div>

</section>

<script type="text/javascript">
    $(document).ready(function () {
        carregar('');
    });

    $('#btnPesquisar').click(function () {
        var pesquisa = $('#pesquisa').val();
        carregar(pesquisa);
    });

    function carregar(text) {
        var url = "/ReportagensTI/ListarReportagensTi/?textoFiltro=" + text;
        $.get(url, null, function (data) {
            $("#ListarReportagensTI").empty().html(data);
            carregaBotoesProximoVoltaPaginacao();
        });
    }
    $(function () {
        $('form').submit(function (event) {
            return checkFocus();
        });
    });
    function checkFocus() {
        if ($('#pesquisa').is(':focus')) {
            return false;
        }
        return true;
    }

    $("#botaoEnviar").click(function () {

        var dTexto = $("#textoComentario").val();

        $.ajax({
            url: "/Home/FaleConoscoDicaTi",
            type: 'POST',
            data: { texto: dTexto },
            beforeSend: function () {
                //blockUI('');

            }
        }).done(function (data) {
           
            $("#textoComentario").val('');

            Swal.fire({
                title: 'Sugestão enviada com sucesso!',
                html: '',
                type: 'success',
                timer: 3000,
                showCancelButton: false,
                showConfirmButton: false,
                focusCancel: true,
                confirmButtonColor: '#dc3545',
                cancelButtonColor: '#6c757d',
                confirmButtonText: 'Sim',
                cancelButtonText: 'Cancelar'
            }).then(function (result) {

            });

        }).fail(function (error) {
            //erroAjax(error, function () { });
        });
    });
    function funPositivo(el) {
        debugger
        var $elemento = $(el),
            dID = $elemento.attr('data-id');
        
        $.ajax({
            url: "/ReportagensTi/AlteraStatus",
            type: 'POST',
            data: { idNotica: dID, status: true },
            beforeSend: function () {
                //blockUI('');
            }
        }).done(function (data) {
      
            carregar('');
            $("#iconPositivo_" + dID).html(data.positivo);
            $("#iconNegativo_" + dID).html(data.negativo);
        }).fail(function (error) {
            //erroAjax(error, function () { });
        });

    }

    function funNegativo(el) {
        debugger
        var $elemento = $(el),
            dID = $elemento.attr('data-id');

        $.ajax({
            url: "/ReportagensTi/AlteraStatus",
            type: 'POST',
            data: { idNotica: dID, status: false },
            beforeSend: function () {
                //blockUI('');
            }
        }).done(function (data) {
       
            carregar('');
            $("#iconPositivo_" + dID).html(data.negativo);
            $("#iconNegativo_" + dID).html(data.positivo);
                        
        }).fail(function (error) {
            //erroAjax(error, function () { });
        });
    }

    function ContarComentarios(dID) {
        $.ajax({
            url: "/ReportagensTi/ContaComentarios",
            type: 'POST',
            data: { idReportagem: dID }
        }).done(function (data) {
                $("#contacomentarios_" + dID).html(data);
            })
    }
</script>
